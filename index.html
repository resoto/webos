<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebOS v6.0 - Vista Edition</title>
    <style>
        /* --- Reset & Variables --- */
        :root {
            --bg-image: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1920&q=80');
            --window-bg: linear-gradient(to bottom, #f0f0f0 0%, #e8e8e8 100%);
            --header-bg: linear-gradient(to bottom, #4a90e2 0%, #357abd 50%, #2a5f8f 100%);
            --header-text: white;
            --taskbar-height: 40px;
            --vista-blue: #4a90e2;
            --vista-blue-dark: #2a5f8f;
            --vista-gray: #f0f0f0;
            --vista-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        * { box-sizing: border-box; user-select: none; }
        body { margin: 0; padding: 0; font-family: "Segoe UI", "Tahoma", sans-serif; overflow: hidden; height: 100vh; width: 100vw; background: #000; }

        /* --- Layers --- */
        .layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; transition: 0.5s; }
        
        /* Boot Screen */
        #boot-screen {
            background: linear-gradient(to bottom, #1a1a1a 0%, #000 100%); 
            z-index: 99999; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white;
        }
        .spinner {
            width: 50px; height: 50px; border: 5px solid #333; border-top: 5px solid #0078d7; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Welcome Screen */
        #welcome-screen {
            background: linear-gradient(to bottom, #4a90e2 0%, #357abd 50%, #2a5f8f 100%);
            z-index: 99998; display: none; flex-direction: column; align-items: center; justify-content: center; 
            color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.3);
            transition: opacity 0.8s ease;
        }
        #welcome-screen.show { display: flex; }
        #welcome-screen.fade-out { opacity: 0; }
        .welcome-logo {
            font-size: 5rem; margin-bottom: 30px; animation: pulse 2s ease-in-out infinite;
        }
        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }
        .welcome-text {
            font-size: 2.5rem; font-weight: 300; margin-bottom: 10px;
        }
        .welcome-subtext {
            font-size: 1.2rem; opacity: 0.9; margin-top: 10px;
        }
        .welcome-progress {
            width: 300px; height: 4px; background: rgba(255,255,255,0.3); border-radius: 2px;
            margin-top: 40px; overflow: hidden;
        }
        .welcome-progress-bar {
            height: 100%; background: white; width: 0%; transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
        }

        /* Shutdown Screen */
        #shutdown-screen {
            background: linear-gradient(to bottom, #1a1a1a 0%, #000 100%);
            z-index: 99999; display: none; flex-direction: column; align-items: center; justify-content: center;
            color: white;
        }
        #shutdown-screen.show { display: flex; }
        .shutdown-text {
            font-size: 2rem; margin-bottom: 20px; opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }
        @keyframes fadeIn { to { opacity: 1; } }

        /* Lock Screen */
        #lock-screen {
            background: var(--bg-image) center/cover no-repeat; z-index: 20000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; text-shadow: 0 2px 10px rgba(0,0,0,0.5);
            transition: transform 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        #lock-screen.unlocked { transform: translateY(-100%); }
        .time-large { font-size: 6rem; font-weight: 300; margin: 0; }
        .login-btn { padding: 10px 40px; background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.4); backdrop-filter: blur(10px); cursor: pointer; border-radius: 30px; font-size: 1rem; }

        /* Desktop */
        #desktop { background: var(--bg-image) center/cover no-repeat; z-index: 1; overflow: hidden; }
        
        .desktop-icons {
            padding: 20px; display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); 
            grid-auto-rows: minmax(100px, auto); gap: 15px; 
            height: calc(100% - var(--taskbar-height)); align-content: start;
        }
        .icon {
            width: 100%; max-width: 100px; padding: 15px 10px; text-align: center; color: white; 
            text-shadow: 0 2px 4px rgba(0,0,0,0.8);
            border-radius: 6px; cursor: pointer; border: 1px solid transparent; 
            transition: all 0.2s ease;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: rgba(255,255,255,0.05);
        }
        .icon:hover { 
            background: rgba(255,255,255,0.2); 
            border-color: rgba(255,255,255,0.4);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transform: translateY(-2px);
        }
        .icon-emoji { font-size: 3rem; display: block; margin-bottom: 8px; }

        /* Windows Vista Style */
        .window {
            position: absolute; background: var(--window-bg); 
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 6px;
            box-shadow: var(--vista-shadow), inset 0 1px 0 rgba(255,255,255,0.5);
            display: flex; flex-direction: column;
            min-width: 200px; min-height: 150px; max-width: 95vw; max-height: 90vh;
            overflow: hidden;
            opacity: 0; transform: scale(0.95); transition: opacity 0.2s ease, transform 0.2s ease;
            pointer-events: none; 
        }
        .window.active { opacity: 1; transform: scale(1); pointer-events: auto; }
        .window.minimized { opacity: 0; transform: translateY(200px) scale(0.5); pointer-events: none; }

        .win-header {
            background: var(--header-bg); color: var(--header-text);
            padding: 6px 8px; height: 32px; display: flex; align-items: center; justify-content: space-between;
            font-weight: 500; font-size: 13px; border-radius: 6px 6px 0 0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        .win-actions { display: flex; gap: 4px; }
        .win-btn { 
            width: 24px; height: 24px; border: none;
            background: rgba(255,255,255,0.2); font-size: 14px; line-height: 1; 
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; border-radius: 3px; transition: all 0.2s;
            color: white;
        }
        .win-btn:hover { background: rgba(255,255,255,0.3); }
        .win-btn:active { background: rgba(0,0,0,0.2); transform: scale(0.95); }
        .win-btn.close:hover { background: rgba(255,0,0,0.7); }
        .win-btn.close { font-family: monospace; font-weight: bold; }

        .win-content { flex: 1; position: relative; background: white; overflow: hidden; }

        /* Minesweeper Styles */
        .ms-outer { background: #c0c0c0; padding: 10px; height: 100%; display: flex; flex-direction: column; align-items: center; }
        .ms-header {
            border: 2px solid; border-color: #808080 #fff #fff #808080;
            width: 100%; padding: 5px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; background: #c0c0c0;
        }
        .ms-counter {
            background: black; color: red; font-family: "Courier New", monospace; font-size: 20px; font-weight: bold;
            padding: 0 2px; border: 1px solid #808080; width: 40px; text-align: center;
        }
        .ms-face {
            width: 26px; height: 26px; font-size: 18px; cursor: pointer;
            border: 2px solid; border-color: #fff #808080 #808080 #fff; background: #c0c0c0;
            display: flex; align-items: center; justify-content: center; padding-bottom: 2px;
        }
        .ms-face:active { border-color: #808080 #fff #fff #808080; padding-top: 2px; padding-bottom: 0; }
        
        .ms-grid {
            display: grid; grid-template-columns: repeat(9, 25px); grid-template-rows: repeat(9, 25px);
            border: 3px solid; border-color: #808080 #fff #fff #808080;
        }
        .ms-cell {
            width: 25px; height: 25px; background: #c0c0c0;
            border: 2px solid; border-color: #fff #808080 #808080 #fff;
            font-weight: bold; font-size: 14px; display: flex; align-items: center; justify-content: center;
            cursor: default;
        }
        .ms-cell.revealed {
            border: 1px solid #808080; background: #c0c0c0;
        }
        .ms-cell.bomb-revealed { background: red; border: 1px solid #808080; }
        
        /* Numbers Colors */
        .ms-c1 { color: blue; } .ms-c2 { color: green; } .ms-c3 { color: red; } .ms-c4 { color: navy; }
        .ms-c5 { color: maroon; } .ms-c6 { color: teal; } .ms-c7 { color: black; } .ms-c8 { color: gray; }

        /* Browser Iframe */
        .browser-nav { 
            display: flex; gap: 5px; padding: 8px; 
            background: linear-gradient(to bottom, #f8f8f8 0%, #e8e8e8 100%);
            border-bottom: 1px solid #c0c0c0; flex-wrap: wrap; align-items: center;
        }
        .browser-toolbar {
            display: flex; gap: 5px; align-items: center;
        }
        .browser-btn {
            padding: 6px 12px; border: 1px solid #b0b0b0; border-radius: 4px;
            background: linear-gradient(to bottom, #ffffff 0%, #e8e8e8 100%);
            cursor: pointer; font-size: 12px; transition: all 0.2s;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .browser-btn:hover { background: linear-gradient(to bottom, #f8f8f8 0%, #e0e0e0 100%); }
        .browser-btn:active { box-shadow: inset 0 2px 4px rgba(0,0,0,0.2); }
        .browser-url-bar {
            flex: 1; min-width: 200px; padding: 6px 10px; border: 1px solid #b0b0b0;
            border-radius: 4px; font-size: 13px;
        }
        .browser-tabs {
            display: flex; gap: 2px; padding: 5px 5px 0 5px; background: #e0e0e0;
            border-bottom: 1px solid #c0c0c0; overflow-x: auto;
        }
        .browser-tab {
            padding: 6px 12px; background: #d0d0d0; border: 1px solid #b0b0b0;
            border-bottom: none; border-radius: 4px 4px 0 0; cursor: pointer;
            font-size: 12px; white-space: nowrap; position: relative;
            transition: all 0.2s;
        }
        .browser-tab.active {
            background: white; border-color: #c0c0c0; z-index: 1;
            box-shadow: 0 -2px 4px rgba(0,0,0,0.1);
        }
        .browser-tab:hover:not(.active) { background: #e0e0e0; }
        .browser-tab-close {
            margin-left: 6px; padding: 0 4px; border-radius: 2px;
            cursor: pointer; opacity: 0.6;
        }
        .browser-tab-close:hover { opacity: 1; background: rgba(255,0,0,0.2); }
        .browser-bookmarks {
            padding: 5px; background: #f0f0f0; border-bottom: 1px solid #c0c0c0;
            display: flex; gap: 5px; flex-wrap: wrap;
        }
        .browser-bookmark {
            padding: 4px 8px; background: white; border: 1px solid #c0c0c0;
            border-radius: 3px; cursor: pointer; font-size: 11px;
            transition: all 0.2s;
        }
        .browser-bookmark:hover {
            background: #e8f4fd; border-color: #4a90e2;
        }
        .iframe-blocker { position: absolute; top:0; left:0; width:100%; height:100%; display: none; }

        /* Taskbar Vista Style */
        #taskbar {
            position: absolute; bottom: 0; left: 0; width: 100%; height: var(--taskbar-height);
            background: linear-gradient(to bottom, #4a90e2 0%, #357abd 50%, #2a5f8f 100%);
            border-top: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 -2px 8px rgba(0,0,0,0.3);
            display: flex; align-items: center; padding: 2px; z-index: 10000;
        }
        .start-btn {
            height: 36px; padding: 0 15px; display: flex; align-items: center; gap: 8px;
            background: linear-gradient(to bottom, #5ba0f2 0%, #4a90e2 50%, #357abd 100%);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 4px;
            font-weight: 600; font-size: 13px; cursor: pointer; margin-right: 5px;
            color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.3);
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.3), 0 1px 2px rgba(0,0,0,0.2);
            transition: all 0.2s;
        }
        .start-btn:hover { background: linear-gradient(to bottom, #6bb0ff 0%, #5ba0f2 50%, #4a90e2 100%); }
        .start-btn:active { box-shadow: inset 0 2px 4px rgba(0,0,0,0.3); transform: translateY(1px); }
        
        .task-container { flex: 1; display: flex; gap: 3px; padding-left: 5px; }
        .task-item {
            min-width: 120px; max-width: 200px; 
            background: rgba(255,255,255,0.15); 
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 4px;
            padding: 6px 10px; font-size: 12px; cursor: pointer; 
            display: flex; align-items: center; gap: 6px;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis; flex-shrink: 1;
            color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.3);
            transition: all 0.2s;
        }
        .task-item:hover { background: rgba(255,255,255,0.25); }
        .task-item.active-task {
            background: rgba(255,255,255,0.3);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }

        .sys-tray { 
            margin-left: auto; padding: 0 10px; font-size: 12px; 
            background: rgba(255,255,255,0.1);
            border-left: 1px solid rgba(255,255,255,0.2);
            height: 36px; display: flex; align-items: center;
            color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        /* Start Menu Vista Style */
        #start-menu {
            position: fixed; bottom: 44px; left: 2px; width: 240px; 
            background: linear-gradient(to bottom, #f8f8f8 0%, #e8e8e8 100%);
            border: 1px solid rgba(0,0,0,0.2);
            border-radius: 6px;
            box-shadow: var(--vista-shadow);
            padding: 4px; z-index: 10001;
            display: none; flex-direction: column; max-height: calc(100vh - 50px);
        }
        #start-menu.open { display: flex; }
        .menu-row { 
            padding: 10px 12px; display: flex; align-items: center; gap: 10px; 
            cursor: pointer; transition: all 0.2s;
            border-radius: 4px; margin: 2px 0;
        }
        .menu-row:hover { 
            background: linear-gradient(to bottom, #4a90e2 0%, #357abd 100%);
            color: white; 
            box-shadow: inset 0 1px 0 rgba(255,255,255,0.3);
        }

        /* Calculator Styles Vista */
        .calc-container { 
            background: linear-gradient(to bottom, #f8f8f8 0%, #e8e8e8 100%);
            padding: 10px; height: 100%; display: flex; flex-direction: column; 
        }
        .calc-display {
            background: linear-gradient(to bottom, #1a1a1a 0%, #000 100%);
            color: #00ff00; font-family: "Courier New", monospace; font-size: 24px;
            padding: 10px; text-align: right; border-radius: 4px; margin-bottom: 10px; 
            min-height: 40px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
        }
        .calc-buttons {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; flex: 1;
        }
        .calc-btn {
            background: linear-gradient(to bottom, #ffffff 0%, #e8e8e8 100%);
            border: 1px solid #b0b0b0; border-radius: 4px; padding: 15px; font-size: 16px; 
            cursor: pointer; font-weight: 600; transition: all 0.2s;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .calc-btn:hover { background: linear-gradient(to bottom, #f8f8f8 0%, #e0e0e0 100%); }
        .calc-btn:active { box-shadow: inset 0 2px 4px rgba(0,0,0,0.2); }
        .calc-btn.operator { 
            background: linear-gradient(to bottom, #ff9800 0%, #f57c00 100%);
            color: white; border-color: #e65100;
        }
        .calc-btn.equals { 
            background: linear-gradient(to bottom, #4a90e2 0%, #357abd 100%);
            color: white; border-color: #2a5f8f;
        }
        .calc-btn.clear { 
            background: linear-gradient(to bottom, #f44336 0%, #d32f2f 100%);
            color: white; border-color: #c62828;
        }

        /* Clock Styles */
        .clock-container { padding: 20px; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #c0c0c0; }
        .clock-display { font-size: 4rem; font-weight: bold; margin: 20px 0; font-family: "Courier New", monospace; }
        .date-display { font-size: 1.5rem; margin-bottom: 30px; }
        .alarm-section { width: 100%; padding: 20px; border: 2px inset; background: white; }
        .alarm-input { padding: 5px; margin: 5px; width: 60px; border: 1px solid #888; }
        .alarm-list { margin-top: 10px; max-height: 150px; overflow-y: auto; }

        /* Paint Styles */
        .paint-toolbar {
            background: #c0c0c0; padding: 5px; border-bottom: 1px solid #888; display: flex; gap: 5px; flex-wrap: wrap;
        }
        .paint-btn {
            padding: 5px 10px; border: 2px outset; background: #e0e0e0; cursor: pointer; font-size: 12px;
        }
        .paint-btn:active { border: 2px inset; }
        .paint-canvas-container { flex: 1; position: relative; overflow: auto; background: white; }
        .paint-canvas { border: 1px solid #888; cursor: crosshair; display: block; }

        /* Calendar Styles Vista */
        .calendar-container { padding: 10px; height: 100%; background: white; }
        .calendar-header {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;
            padding: 8px; background: linear-gradient(to bottom, #f8f8f8 0%, #e8e8e8 100%);
            border: 1px solid #c0c0c0; border-radius: 4px;
        }
        .calendar-nav-btn { 
            padding: 6px 16px; border: 1px solid #b0b0b0; border-radius: 4px;
            background: linear-gradient(to bottom, #ffffff 0%, #e8e8e8 100%);
            cursor: pointer; transition: all 0.2s;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .calendar-nav-btn:hover { background: linear-gradient(to bottom, #f8f8f8 0%, #e0e0e0 100%); }
        .calendar-nav-btn:active { box-shadow: inset 0 2px 4px rgba(0,0,0,0.2); }
        .calendar-grid {
            display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px;
        }
        .calendar-day-header {
            background: linear-gradient(to bottom, #4a90e2 0%, #357abd 100%);
            color: white; padding: 8px; text-align: center; font-weight: 600; font-size: 12px;
            border-radius: 4px 4px 0 0;
        }
        .calendar-day {
            background: #f8f8f8; padding: 8px; text-align: center; cursor: pointer; 
            border: 1px solid #e0e0e0; border-radius: 4px;
            min-height: 30px; display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
        }
        .calendar-day:hover { 
            background: linear-gradient(to bottom, #e8f4fd 0%, #d0e8fd 100%);
            border-color: #4a90e2;
        }
        .calendar-day.other-month { color: #999; background: #f0f0f0; }
        .calendar-day.today { 
            background: linear-gradient(to bottom, #fff9c4 0%, #fff59d 100%);
            font-weight: bold; border-color: #ffc107;
        }

        /* Stopwatch Styles Vista */
        .stopwatch-container {
            padding: 30px; height: 100%; display: flex; flex-direction: column; align-items: center;
            justify-content: center; background: linear-gradient(to bottom, #f8f8f8 0%, #e8e8e8 100%);
        }
        .stopwatch-display {
            font-size: 5rem; font-family: "Courier New", monospace; font-weight: bold;
            margin: 30px 0; background: linear-gradient(to bottom, #1a1a1a 0%, #000 100%);
            color: #00ff00; padding: 20px 40px; border-radius: 8px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.5), 0 4px 8px rgba(0,0,0,0.3);
        }
        .stopwatch-controls {
            display: flex; gap: 10px; margin-top: 20px;
        }
        .stopwatch-btn {
            padding: 10px 20px; border: 1px solid #b0b0b0; border-radius: 4px;
            background: linear-gradient(to bottom, #ffffff 0%, #e8e8e8 100%);
            cursor: pointer; font-size: 14px; font-weight: 600;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }
        .stopwatch-btn:hover { background: linear-gradient(to bottom, #f8f8f8 0%, #e0e0e0 100%); }
        .stopwatch-btn:active { box-shadow: inset 0 2px 4px rgba(0,0,0,0.2); }
        .stopwatch-btn.start { 
            background: linear-gradient(to bottom, #4caf50 0%, #388e3c 100%);
            color: white; border-color: #2e7d32;
        }
        .stopwatch-btn.stop { 
            background: linear-gradient(to bottom, #f44336 0%, #d32f2f 100%);
            color: white; border-color: #c62828;
        }
        .stopwatch-btn.reset { 
            background: linear-gradient(to bottom, #ff9800 0%, #f57c00 100%);
            color: white; border-color: #e65100;
        }
        .stopwatch-laps {
            margin-top: 20px; max-height: 200px; overflow-y: auto; width: 100%;
            background: white; border: 2px inset; padding: 10px;
        }

        /* Vista Style Buttons */
        .vista-btn {
            background: linear-gradient(to bottom, #ffffff 0%, #e8e8e8 100%);
            border: 1px solid #b0b0b0;
            border-radius: 4px;
            padding: 6px 16px;
            font-size: 12px;
            cursor: pointer;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1), inset 0 1px 0 rgba(255,255,255,0.8);
            transition: all 0.2s;
        }
        .vista-btn:hover {
            background: linear-gradient(to bottom, #f8f8f8 0%, #e0e0e0 100%);
            box-shadow: 0 2px 4px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.9);
        }
        .vista-btn:active {
            background: linear-gradient(to bottom, #e0e0e0 0%, #d0d0d0 100%);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
        }

        /* File Explorer Styles */
        .explorer-toolbar {
            background: linear-gradient(to bottom, #f8f8f8 0%, #e8e8e8 100%);
            padding: 8px; border-bottom: 1px solid #c0c0c0;
            display: flex; gap: 5px; align-items: center;
        }
        .explorer-sidebar {
            width: 200px; background: #f5f5f5; border-right: 1px solid #c0c0c0;
            padding: 10px; overflow-y: auto;
        }
        .explorer-content {
            flex: 1; padding: 10px; overflow-y: auto; background: white;
        }
        .file-item {
            padding: 8px; margin: 2px 0; border-radius: 4px; cursor: pointer;
            display: flex; align-items: center; gap: 8px;
            transition: background 0.2s;
        }
        .file-item:hover { background: #e8f4fd; }
        .file-item.selected { background: #cce8ff; }

        /* Media Player Styles */
        .player-controls {
            background: linear-gradient(to bottom, #2a2a2a 0%, #1a1a1a 100%);
            padding: 15px; display: flex; align-items: center; gap: 10px;
            border-top: 1px solid #000;
        }
        .player-btn {
            width: 40px; height: 40px; border-radius: 50%;
            background: linear-gradient(to bottom, #4a4a4a 0%, #2a2a2a 100%);
            border: 1px solid #000; color: white; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-size: 18px; transition: all 0.2s;
        }
        .player-btn:hover { background: linear-gradient(to bottom, #5a5a5a 0%, #3a3a3a 100%); }
        .player-btn.play { width: 50px; height: 50px; font-size: 24px; }
        .player-progress {
            flex: 1; height: 6px; background: #333; border-radius: 3px;
            position: relative; cursor: pointer;
        }
        .player-progress-bar {
            height: 100%; background: linear-gradient(to bottom, #4a90e2 0%, #357abd 100%);
            border-radius: 3px; width: 0%;
        }
        .player-info {
            padding: 15px; background: #1a1a1a; color: white;
            text-align: center; font-size: 14px;
        }

        /* Weather Styles */
        .weather-container {
            padding: 20px; background: linear-gradient(to bottom, #87ceeb 0%, #4682b4 100%);
            color: white; height: 100%;
        }
        .weather-main {
            text-align: center; margin: 20px 0;
        }
        .weather-temp {
            font-size: 4rem; font-weight: 300; margin: 10px 0;
        }
        .weather-desc {
            font-size: 1.5rem; margin: 10px 0;
        }
        .weather-details {
            background: rgba(255,255,255,0.2); border-radius: 8px;
            padding: 15px; margin-top: 20px;
        }
        .weather-item {
            display: flex; justify-content: space-between; padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        /* Task Manager Styles */
        .taskmgr-tabs {
            display: flex; background: #e8e8e8; border-bottom: 1px solid #c0c0c0;
        }
        .taskmgr-tab {
            padding: 8px 16px; cursor: pointer; border-right: 1px solid #c0c0c0;
            background: #f0f0f0; transition: background 0.2s;
        }
        .taskmgr-tab.active {
            background: white; border-bottom: 2px solid #4a90e2;
        }
        .taskmgr-content {
            padding: 10px; height: calc(100% - 40px); overflow-y: auto;
        }
        .taskmgr-list {
            list-style: none; padding: 0; margin: 0;
        }
        .taskmgr-item {
            padding: 8px; border-bottom: 1px solid #e0e0e0;
            display: flex; justify-content: space-between; align-items: center;
        }
        .taskmgr-item:hover { background: #f5f5f5; }
    </style>
</head>
<body>

    <!-- Audio elements for startup and shutdown sounds -->
    <audio id="startup-sound" preload="auto"></audio>
    <audio id="shutdown-sound" preload="auto"></audio>

    <div id="boot-screen" class="layer">
        <div class="spinner"></div>
        <h2>WebOS v6.0</h2>
        <p>Vista Edition</p>
    </div>

    <div id="welcome-screen" class="layer">
        <div class="welcome-logo">‚ùñ</div>
        <div class="welcome-text">„Çà„ÅÜ„Åì„Åù</div>
        <div class="welcome-subtext">Welcome to WebOS v6.0</div>
        <div class="welcome-progress">
            <div class="welcome-progress-bar" id="welcome-progress"></div>
        </div>
    </div>

    <div id="shutdown-screen" class="layer">
        <div class="shutdown-text">„Ç∑„É£„ÉÉ„Éà„ÉÄ„Ç¶„É≥„Åó„Å¶„ÅÑ„Åæ„Åô...</div>
        <div class="spinner"></div>
    </div>

    <div id="lock-screen" class="layer" style="display:none;">
        <div class="time-large" id="lock-time">12:00</div>
        <button class="login-btn" onclick="unlockSystem()">Click to Login</button>
    </div>

    <div id="desktop" class="layer" style="display:none;">
        
        <div class="desktop-icons">
            <div class="icon" onclick="app.open('game')">
                <span class="icon-emoji">üí£</span>
                <span>„Éû„Ç§„É≥„Çπ„Ç§„Éº„Éë</span>
            </div>
            <div class="icon" onclick="app.open('browser')">
                <span class="icon-emoji">üåê</span>
                <span>„Éñ„É©„Ç¶„Ç∂</span>
            </div>
            <div class="icon" onclick="app.open('notepad')">
                <span class="icon-emoji">üìù</span>
                <span>„É°„É¢Â∏≥</span>
            </div>
            <div class="icon" onclick="app.open('settings')">
                <span class="icon-emoji">‚öôÔ∏è</span>
                <span>Ë®≠ÂÆö</span>
            </div>
            <div class="icon" onclick="app.open('calculator')">
                <span class="icon-emoji">üî¢</span>
                <span>Ë®àÁÆóÊ©ü</span>
            </div>
            <div class="icon" onclick="app.open('clock')">
                <span class="icon-emoji">üïê</span>
                <span>ÊôÇË®à</span>
            </div>
            <div class="icon" onclick="app.open('paint')">
                <span class="icon-emoji">üé®</span>
                <span>„Éö„Ç§„É≥„Éà</span>
            </div>
            <div class="icon" onclick="app.open('calendar')">
                <span class="icon-emoji">üìÖ</span>
                <span>„Ç´„É¨„É≥„ÉÄ„Éº</span>
            </div>
            <div class="icon" onclick="app.open('stopwatch')">
                <span class="icon-emoji">‚è±Ô∏è</span>
                <span>„Çπ„Éà„ÉÉ„Éó„Ç¶„Ç©„ÉÉ„ÉÅ</span>
            </div>
            <div class="icon" onclick="app.open('explorer')">
                <span class="icon-emoji">üìÅ</span>
                <span>„Ç®„ÇØ„Çπ„Éó„É≠„Éº„É©„Éº</span>
            </div>
            <div class="icon" onclick="app.open('media')">
                <span class="icon-emoji">üéµ</span>
                <span>„É°„Éá„Ç£„Ç¢„Éó„É¨„Éº„É§„Éº</span>
            </div>
            <div class="icon" onclick="app.open('weather')">
                <span class="icon-emoji">‚òÄÔ∏è</span>
                <span>Â§©Ê∞ó</span>
            </div>
            <div class="icon" onclick="app.open('taskmgr')">
                <span class="icon-emoji">üìä</span>
                <span>„Çø„Çπ„ÇØ„Éû„Éç„Éº„Ç∏„É£„Éº</span>
            </div>
        </div>

        <div id="win-game" class="window" style="width: 300px; height: 380px; top: 10%; left: 10%;" data-title="„Éû„Ç§„É≥„Çπ„Ç§„Éº„Éë">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-game')">
                <span>„Éû„Ç§„É≥„Çπ„Ç§„Éº„Éë</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-game')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-game')">√ó</button>
                </div>
            </div>
            <div class="win-content">
                <div class="ms-outer" oncontextmenu="return false;">
                    <div class="ms-header">
                        <div class="ms-counter" id="ms-bomb-count">010</div>
                        <button class="ms-face" id="ms-face-btn" onclick="minesweeper.init()">üôÇ</button>
                        <div class="ms-counter" id="ms-timer">000</div>
                    </div>
                    <div id="ms-grid" class="ms-grid"></div>
                </div>
            </div>
        </div>

        <div id="win-browser" class="window" style="width: 80%; max-width: 900px; height: 70%; max-height: 700px; top: 5%; left: 10%;" data-title="„Éñ„É©„Ç¶„Ç∂">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-browser')">
                <span>Web Browser</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-browser')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-browser')">√ó</button>
                </div>
            </div>
            <div class="win-content" style="display:flex; flex-direction:column;">
                <div class="browser-toolbar">
                    <button class="browser-btn" onclick="browser.goBack()" title="Êàª„Çã">‚Üê</button>
                    <button class="browser-btn" onclick="browser.goForward()" title="ÈÄ≤„ÇÄ">‚Üí</button>
                    <button class="browser-btn" onclick="browser.refresh()" title="Êõ¥Êñ∞">üîÑ</button>
                    <button class="browser-btn" onclick="browser.home()" title="„Éõ„Éº„É†">üè†</button>
                    <input type="text" class="browser-url-bar" id="browser-url" 
                           value="https://ja.m.wikipedia.org/wiki/Main_Page" 
                           onkeydown="if(event.key==='Enter') browser.go()">
                    <button class="browser-btn" onclick="browser.go()">ÁßªÂãï</button>
                    <button class="browser-btn" onclick="browser.addBookmark()" title="„Éñ„ÉÉ„ÇØ„Éû„Éº„ÇØ">‚≠ê</button>
                    <button class="browser-btn" onclick="browser.showHistory()" title="Â±•Ê≠¥">üìú</button>
                </div>
                <div class="browser-bookmarks" id="browser-bookmarks" style="display:none;">
                    <!-- Bookmarks will be added here -->
                </div>
                <div class="browser-tabs" id="browser-tabs">
                    <div class="browser-tab active" data-tab="0" onclick="browser.switchTab(0)">
                        <span>Êñ∞„Åó„ÅÑ„Çø„Éñ</span>
                        <span class="browser-tab-close" onclick="browser.closeTab(0, event)">√ó</span>
                    </div>
                </div>
                <div style="flex:1; position:relative; background:white;">
                    <div class="iframe-blocker" id="browser-blocker"></div>
                    <div id="browser-frames-container" style="width:100%; height:100%; position:relative;">
                        <iframe class="browser-frame active" data-tab="0" id="browser-frame-0" 
                                src="about:blank" style="width:100%; height:100%; border:none; display:block;"></iframe>
                    </div>
                </div>
            </div>
        </div>

        <div id="win-notepad" class="window" style="width: 400px; height: 350px; top: 15%; left: 15%;" data-title="„É°„É¢Â∏≥">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-notepad')">
                <span>ÁÑ°È°å - „É°„É¢Â∏≥</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-notepad')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-notepad')">√ó</button>
                </div>
            </div>
            <div class="win-content">
                <textarea style="width:100%; height:100%; resize:none; border:none; padding:5px;"></textarea>
            </div>
        </div>

        <div id="win-settings" class="window" style="width: 350px; height: 300px; top: 20%; left: 20%;" data-title="Ë®≠ÂÆö">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-settings')">
                <span>Ë®≠ÂÆö</span>
                <div class="win-actions"><button class="win-btn close" onclick="wm.close('win-settings')">√ó</button></div>
            </div>
            <div class="win-content" style="padding:10px;">
                <p>ËÉåÊôØË®≠ÂÆö:</p>
                <button onclick="document.documentElement.style.setProperty('--bg-image', 'url(https://images.unsplash.com/photo-1477346611705-65d1883cee1e?auto=format&fit=crop&w=1920)')">Â±±</button>
                <button onclick="document.documentElement.style.setProperty('--bg-image', 'url(https://images.unsplash.com/photo-1480714378408-67cf0d13bc1b?auto=format&fit=crop&w=1920)')">ÈÉΩÂ∏Ç</button>
            </div>
        </div>

        <div id="win-calculator" class="window" style="width: 280px; height: 380px; top: 10%; left: 15%;" data-title="Ë®àÁÆóÊ©ü">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-calculator')">
                <span>Ë®àÁÆóÊ©ü</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-calculator')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-calculator')">√ó</button>
                </div>
            </div>
            <div class="win-content">
                <div class="calc-container">
                    <div class="calc-display" id="calc-display">0</div>
                    <div class="calc-buttons" id="calc-buttons"></div>
                </div>
            </div>
        </div>

        <div id="win-clock" class="window" style="width: 400px; height: 500px; top: 10%; left: 20%;" data-title="ÊôÇË®à">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-clock')">
                <span>ÊôÇË®à„Éª„Ç¢„É©„Éº„É†</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-clock')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-clock')">√ó</button>
                </div>
            </div>
            <div class="win-content">
                <div class="clock-container">
                    <div class="date-display" id="clock-date"></div>
                    <div class="clock-display" id="clock-time-display">00:00:00</div>
                    <div class="alarm-section">
                        <h3>„Ç¢„É©„Éº„É†Ë®≠ÂÆö</h3>
                        <div>
                            <input type="number" class="alarm-input" id="alarm-hour" min="0" max="23" value="12" placeholder="ÊôÇ">
                            <span>:</span>
                            <input type="number" class="alarm-input" id="alarm-minute" min="0" max="59" value="0" placeholder="ÂàÜ">
                            <button class="paint-btn" onclick="clockApp.addAlarm()">ËøΩÂä†</button>
                        </div>
                        <div class="alarm-list" id="alarm-list"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="win-paint" class="window" style="width: 600px; height: 500px; top: 5%; left: 10%;" data-title="„Éö„Ç§„É≥„Éà">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-paint')">
                <span>„Éö„Ç§„É≥„Éà</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-paint')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-paint')">√ó</button>
                </div>
            </div>
            <div class="win-content" style="display:flex; flex-direction:column;">
                <div class="paint-toolbar">
                    <button class="paint-btn" onclick="paintApp.clear()">„ÇØ„É™„Ç¢</button>
                    <input type="color" id="paint-color" value="#000000" onchange="paintApp.setColor(this.value)">
                    <input type="range" id="paint-size" min="1" max="20" value="5" oninput="paintApp.setSize(this.value)">
                    <span id="paint-size-display">5px</span>
                </div>
                <div class="paint-canvas-container">
                    <canvas id="paint-canvas" class="paint-canvas" width="550" height="400"></canvas>
                </div>
            </div>
        </div>

        <div id="win-calendar" class="window" style="width: 500px; height: 450px; top: 10%; left: 15%;" data-title="„Ç´„É¨„É≥„ÉÄ„Éº">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-calendar')">
                <span>„Ç´„É¨„É≥„ÉÄ„Éº</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-calendar')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-calendar')">√ó</button>
                </div>
            </div>
            <div class="win-content">
                <div class="calendar-container">
                    <div class="calendar-header">
                        <button class="calendar-nav-btn" onclick="calendarApp.prevMonth()">‚Üê</button>
                        <span id="calendar-month-year" style="font-weight:bold; font-size:16px;"></span>
                        <button class="calendar-nav-btn" onclick="calendarApp.nextMonth()">‚Üí</button>
                    </div>
                    <div class="calendar-grid" id="calendar-grid"></div>
                </div>
            </div>
        </div>

        <div id="win-stopwatch" class="window" style="width: 400px; height: 400px; top: 15%; left: 20%;" data-title="„Çπ„Éà„ÉÉ„Éó„Ç¶„Ç©„ÉÉ„ÉÅ">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-stopwatch')">
                <span>„Çπ„Éà„ÉÉ„Éó„Ç¶„Ç©„ÉÉ„ÉÅ</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-stopwatch')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-stopwatch')">√ó</button>
                </div>
            </div>
            <div class="win-content">
                <div class="stopwatch-container">
                    <div class="stopwatch-display" id="stopwatch-display">00:00:00</div>
                    <div class="stopwatch-controls">
                        <button class="stopwatch-btn start" id="stopwatch-start" onclick="stopwatchApp.start()">ÈñãÂßã</button>
                        <button class="stopwatch-btn stop" id="stopwatch-stop" onclick="stopwatchApp.stop()" style="display:none;">ÂÅúÊ≠¢</button>
                        <button class="stopwatch-btn reset" onclick="stopwatchApp.reset()">„É™„Çª„ÉÉ„Éà</button>
                        <button class="stopwatch-btn" onclick="stopwatchApp.lap()">„É©„ÉÉ„Éó</button>
                    </div>
                    <div class="stopwatch-laps" id="stopwatch-laps"></div>
                </div>
            </div>
        </div>

        <div id="win-explorer" class="window" style="width: 700px; height: 500px; top: 10%; left: 15%;" data-title="„Ç®„ÇØ„Çπ„Éó„É≠„Éº„É©„Éº">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-explorer')">
                <span>„Ç®„ÇØ„Çπ„Éó„É≠„Éº„É©„Éº</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-explorer')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-explorer')">√ó</button>
                </div>
            </div>
            <div class="win-content" style="display:flex; flex-direction:column;">
                <div class="explorer-toolbar">
                    <button class="vista-btn" onclick="explorerApp.goBack()">‚Üê Êàª„Çã</button>
                    <button class="vista-btn" onclick="explorerApp.goForward()">ÈÄ≤„ÇÄ ‚Üí</button>
                    <button class="vista-btn" onclick="explorerApp.refresh()">üîÑ</button>
                    <div style="flex:1;"></div>
                    <input type="text" placeholder="Ê§úÁ¥¢..." style="padding:4px 8px; border:1px solid #b0b0b0; border-radius:4px; width:200px;">
                </div>
                <div style="display:flex; flex:1; overflow:hidden;">
                    <div class="explorer-sidebar">
                        <div class="file-item" onclick="explorerApp.navigate('desktop')">üñ•Ô∏è „Éá„Çπ„ÇØ„Éà„ÉÉ„Éó</div>
                        <div class="file-item" onclick="explorerApp.navigate('documents')">üìÑ „Éâ„Ç≠„É•„É°„É≥„Éà</div>
                        <div class="file-item" onclick="explorerApp.navigate('pictures')">üñºÔ∏è „Éî„ÇØ„ÉÅ„É£</div>
                        <div class="file-item" onclick="explorerApp.navigate('music')">üéµ „Éü„É•„Éº„Ç∏„ÉÉ„ÇØ</div>
                        <div class="file-item" onclick="explorerApp.navigate('videos')">üé¨ „Éì„Éá„Ç™</div>
                    </div>
                    <div class="explorer-content" id="explorer-content">
                        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap:10px;">
                            <div class="file-item" onclick="explorerApp.selectFile('file1.txt')">üìÑ file1.txt</div>
                            <div class="file-item" onclick="explorerApp.selectFile('image.jpg')">üñºÔ∏è image.jpg</div>
                            <div class="file-item" onclick="explorerApp.selectFile('document.pdf')">üìÑ document.pdf</div>
                            <div class="file-item" onclick="explorerApp.selectFile('music.mp3')">üéµ music.mp3</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="win-media" class="window" style="width: 500px; height: 400px; top: 15%; left: 20%;" data-title="„É°„Éá„Ç£„Ç¢„Éó„É¨„Éº„É§„Éº">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-media')">
                <span>Windows Media Player</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-media')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-media')">√ó</button>
                </div>
            </div>
            <div class="win-content" style="display:flex; flex-direction:column; background:#1a1a1a;">
                <div class="player-info" id="media-info">
                    <div style="font-size:18px; font-weight:bold;">Now Playing</div>
                    <div id="media-title" style="margin-top:10px;">Êõ≤Âêç„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô</div>
                    <div id="media-artist" style="opacity:0.8; margin-top:5px;">„Ç¢„Éº„ÉÜ„Ç£„Çπ„ÉàÂêç</div>
                </div>
                <div style="flex:1; background:linear-gradient(to bottom, #2a2a2a 0%, #1a1a1a 100%); display:flex; align-items:center; justify-content:center; color:white; font-size:48px;">
                    üéµ
                </div>
                <div class="player-controls">
                    <button class="player-btn" onclick="mediaPlayer.prev()">‚èÆ</button>
                    <button class="player-btn play" id="media-play" onclick="mediaPlayer.toggle()">‚ñ∂</button>
                    <button class="player-btn" onclick="mediaPlayer.next()">‚è≠</button>
                    <div class="player-progress" onclick="mediaPlayer.seek(event)">
                        <div class="player-progress-bar" id="media-progress"></div>
                    </div>
                    <div style="color:white; min-width:60px; text-align:center; font-size:12px;">
                        <span id="media-time">0:00</span> / <span id="media-duration">3:45</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="win-weather" class="window" style="width: 400px; height: 500px; top: 10%; left: 25%;" data-title="Â§©Ê∞ó">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-weather')">
                <span>Â§©Ê∞ó</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-weather')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-weather')">√ó</button>
                </div>
            </div>
            <div class="win-content">
                <div class="weather-container">
                    <div class="weather-main">
                        <div style="font-size:5rem; margin:20px 0;">‚òÄÔ∏è</div>
                        <div class="weather-temp" id="weather-temp">22¬∞</div>
                        <div class="weather-desc" id="weather-desc">Êô¥„Çå</div>
                        <div style="margin-top:10px; opacity:0.9;" id="weather-location">Êù±‰∫¨, Êó•Êú¨</div>
                    </div>
                    <div class="weather-details">
                        <div class="weather-item">
                            <span>‰ΩìÊÑüÊ∏©Â∫¶</span>
                            <span id="weather-feels">24¬∞</span>
                        </div>
                        <div class="weather-item">
                            <span>ÊπøÂ∫¶</span>
                            <span id="weather-humidity">65%</span>
                        </div>
                        <div class="weather-item">
                            <span>È¢®ÈÄü</span>
                            <span id="weather-wind">12 km/h</span>
                        </div>
                        <div class="weather-item">
                            <span>Ê∞óÂúß</span>
                            <span id="weather-pressure">1013 hPa</span>
                        </div>
                    </div>
                    <div style="margin-top:20px; text-align:center;">
                        <button class="vista-btn" onclick="weatherApp.refresh()" style="background:rgba(255,255,255,0.3); color:white; border-color:rgba(255,255,255,0.5);">Êõ¥Êñ∞</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="win-taskmgr" class="window" style="width: 600px; height: 500px; top: 10%; left: 20%;" data-title="„Çø„Çπ„ÇØ„Éû„Éç„Éº„Ç∏„É£„Éº">
            <div class="win-header" onmousedown="wm.startDrag(event, 'win-taskmgr')">
                <span>„Çø„Çπ„ÇØ„Éû„Éç„Éº„Ç∏„É£„Éº</span>
                <div class="win-actions">
                    <button class="win-btn" onclick="wm.minimize('win-taskmgr')">_</button>
                    <button class="win-btn close" onclick="wm.close('win-taskmgr')">√ó</button>
                </div>
            </div>
            <div class="win-content" style="display:flex; flex-direction:column;">
                <div class="taskmgr-tabs">
                    <div class="taskmgr-tab active" onclick="taskMgr.switchTab('processes')">„Éó„É≠„Çª„Çπ</div>
                    <div class="taskmgr-tab" onclick="taskMgr.switchTab('performance')">„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ</div>
                </div>
                <div class="taskmgr-content" id="taskmgr-content">
                    <ul class="taskmgr-list" id="taskmgr-list">
                        <li class="taskmgr-item">
                            <span>„Éû„Ç§„É≥„Çπ„Ç§„Éº„Éë</span>
                            <span>12.5 MB</span>
                        </li>
                        <li class="taskmgr-item">
                            <span>„Éñ„É©„Ç¶„Ç∂</span>
                            <span>45.2 MB</span>
                        </li>
                        <li class="taskmgr-item">
                            <span>„É°„É¢Â∏≥</span>
                            <span>8.1 MB</span>
                        </li>
                        <li class="taskmgr-item">
                            <span>Ë®àÁÆóÊ©ü</span>
                            <span>5.3 MB</span>
                        </li>
                        <li class="taskmgr-item">
                            <span>ÊôÇË®à</span>
                            <span>6.7 MB</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div id="taskbar">
            <div class="start-btn" onclick="sys.toggleStart()">
                <span style="color:red; font-weight:900;">‚ùñ</span> Start
            </div>
            <div class="task-container" id="task-list"></div>
            <div class="sys-tray">
                <span id="clock">00:00</span>
            </div>
        </div>

        <div id="start-menu">
            <div class="menu-row" onclick="app.open('game'); sys.toggleStart()">üí£ „Éû„Ç§„É≥„Çπ„Ç§„Éº„Éë</div>
            <div class="menu-row" onclick="app.open('browser'); sys.toggleStart()">üåê „Éñ„É©„Ç¶„Ç∂</div>
            <div class="menu-row" onclick="app.open('notepad'); sys.toggleStart()">üìù „É°„É¢Â∏≥</div>
            <div class="menu-row" onclick="app.open('calculator'); sys.toggleStart()">üî¢ Ë®àÁÆóÊ©ü</div>
            <div class="menu-row" onclick="app.open('clock'); sys.toggleStart()">üïê ÊôÇË®à</div>
            <div class="menu-row" onclick="app.open('paint'); sys.toggleStart()">üé® „Éö„Ç§„É≥„Éà</div>
            <div class="menu-row" onclick="app.open('calendar'); sys.toggleStart()">üìÖ „Ç´„É¨„É≥„ÉÄ„Éº</div>
            <div class="menu-row" onclick="app.open('stopwatch'); sys.toggleStart()">‚è±Ô∏è „Çπ„Éà„ÉÉ„Éó„Ç¶„Ç©„ÉÉ„ÉÅ</div>
            <div class="menu-row" onclick="app.open('explorer'); sys.toggleStart()">üìÅ „Ç®„ÇØ„Çπ„Éó„É≠„Éº„É©„Éº</div>
            <div class="menu-row" onclick="app.open('media'); sys.toggleStart()">üéµ „É°„Éá„Ç£„Ç¢„Éó„É¨„Éº„É§„Éº</div>
            <div class="menu-row" onclick="app.open('weather'); sys.toggleStart()">‚òÄÔ∏è Â§©Ê∞ó</div>
            <div class="menu-row" onclick="app.open('taskmgr'); sys.toggleStart()">üìä „Çø„Çπ„ÇØ„Éû„Éç„Éº„Ç∏„É£„Éº</div>
            <div style="height:1px; background:#808080; margin:5px 0;"></div>
            <div class="menu-row" onclick="app.open('settings'); sys.toggleStart()">‚öôÔ∏è Ë®≠ÂÆö</div>
            <div style="height:1px; background:#808080; margin:5px 0;"></div>
            <div class="menu-row" onclick="sys.shutdown()">‚èª „Ç∑„É£„ÉÉ„Éà„ÉÄ„Ç¶„É≥</div>
        </div>

    </div>

    <script>
        /* --- SYSTEM --- */
        const sys = {
            playStartupSound: () => {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 800;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                } catch(e) {}
            },
            playShutdownSound: () => {
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = 400;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.0);
                    
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 1.0);
                } catch(e) {}
            },
            boot: () => {
                // Play startup sound
                sys.playStartupSound();
                
                setTimeout(() => {
                    document.getElementById('boot-screen').style.display = 'none';
                    // Show welcome screen
                    const welcome = document.getElementById('welcome-screen');
                    welcome.classList.add('show');
                    
                    // Progress bar animation
                    let progress = 0;
                    const progressBar = document.getElementById('welcome-progress');
                    const progressInterval = setInterval(() => {
                        progress += Math.random() * 15;
                        if(progress > 100) progress = 100;
                        progressBar.style.width = progress + '%';
                        if(progress >= 100) {
                            clearInterval(progressInterval);
                            setTimeout(() => {
                                welcome.classList.add('fade-out');
                                setTimeout(() => {
                                    welcome.style.display = 'none';
                                    document.getElementById('lock-screen').style.display = 'flex';
                                    sys.updateClock();
                                }, 800);
                            }, 500);
                        }
                    }, 100);
                }, 2000);
            },
            updateClock: () => {
                const now = new Date();
                const t = now.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
                document.getElementById('clock').textContent = t;
                document.getElementById('lock-time').textContent = t;
            },
            toggleStart: () => document.getElementById('start-menu').classList.toggle('open'),
            shutdown: () => {
                // Play shutdown sound
                sys.playShutdownSound();
                
                const shutdown = document.getElementById('shutdown-screen');
                shutdown.classList.add('show');
                document.getElementById('desktop').style.filter='grayscale(1)';
                document.getElementById('desktop').style.opacity='0.5';
                
                setTimeout(() => {
                    shutdown.querySelector('.shutdown-text').textContent = '„Ç≥„É≥„Éî„É•„Éº„Çø„Éº„ÇíÂÆâÂÖ®„Å´„Ç∑„É£„ÉÉ„Éà„ÉÄ„Ç¶„É≥„Åó„Åæ„Åó„Åü';
                    setTimeout(() => {
                        location.reload();
                    }, 2000);
                }, 2000);
            }
        };
        setInterval(sys.updateClock, 1000);
        window.onload = sys.boot;
        function unlockSystem() {
            document.getElementById('lock-screen').classList.add('unlocked');
            document.getElementById('desktop').style.display = 'block';
        }

        /* --- WM --- */
        let zIndex = 100;
        const wm = {
            open: (id) => {
                const w = document.getElementById(id);
                w.classList.remove('minimized'); w.classList.add('active');
                wm.toFront(w);
                taskbar.add(id, w.dataset.title);
            },
            close: (id) => {
                document.getElementById(id).classList.remove('active');
                taskbar.remove(id);
                if(id==='win-game') minesweeper.reset();
            },
            minimize: (id) => {
                document.getElementById(id).classList.add('minimized');
                document.getElementById(id).classList.remove('active');
                taskbar.update(null);
            },
            toFront: (w) => {
                w.style.zIndex = ++zIndex;
                taskbar.update(w.id);
            },
            startDrag: (e, id) => {
                if(e.target.classList.contains('win-btn')) return;
                const w = document.getElementById(id);
                wm.toFront(w);
                if(id === 'win-browser') document.getElementById('browser-blocker').style.display='block';
                
                const r = w.getBoundingClientRect();
                const offX = e.clientX - r.left, offY = e.clientY - r.top;
                
                const move = (ev) => {
                    w.style.left = (ev.clientX - offX) + 'px';
                    w.style.top = Math.max(0, ev.clientY - offY) + 'px';
                };
                const stop = () => {
                    document.removeEventListener('mousemove', move);
                    document.removeEventListener('mouseup', stop);
                    if(id === 'win-browser') document.getElementById('browser-blocker').style.display='none';
                };
                document.addEventListener('mousemove', move);
                document.addEventListener('mouseup', stop);
            }
        };
        document.querySelectorAll('.window').forEach(w=>w.addEventListener('mousedown',()=>wm.toFront(w)));

        /* --- TASKBAR --- */
        const taskbar = {
            add: (id, title) => {
                if(document.getElementById('task-'+id)) return;
                const el = document.createElement('div');
                el.id = 'task-'+id; el.className='task-item active-task';
                const icons = {
                    'win-game': 'üí£ ', 'win-browser': 'üåê ', 'win-notepad': 'üìù ',
                    'win-calculator': 'üî¢ ', 'win-clock': 'üïê ', 'win-paint': 'üé® ',
                    'win-calendar': 'üìÖ ', 'win-stopwatch': '‚è±Ô∏è ', 'win-settings': '‚öôÔ∏è ',
                    'win-explorer': 'üìÅ ', 'win-media': 'üéµ ', 'win-weather': '‚òÄÔ∏è ', 'win-taskmgr': 'üìä '
                };
                el.innerHTML = (icons[id] || 'üìÑ ') + title;
                el.onclick = () => {
                    const w = document.getElementById(id);
                    if(w.classList.contains('active') && w.style.zIndex==zIndex) wm.minimize(id);
                    else wm.open(id);
                };
                document.getElementById('task-list').appendChild(el);
            },
            remove: (id) => { const el = document.getElementById('task-'+id); if(el) el.remove(); },
            update: (id) => {
                document.querySelectorAll('.task-item').forEach(t => t.classList.remove('active-task'));
                if(id) document.getElementById('task-'+id)?.classList.add('active-task');
            }
        };

        /* --- APPS --- */
        const app = {
            open: (name) => {
                wm.open('win-'+name);
                if(name==='browser') browser.init();
                if(name==='game') minesweeper.init();
                if(name==='calculator') calculator.init();
                if(name==='clock') clockApp.init();
                if(name==='paint') paintApp.init();
                if(name==='calendar') calendarApp.init();
                if(name==='stopwatch') stopwatchApp.init();
                if(name==='explorer') explorerApp.init();
                if(name==='media') mediaPlayer.init();
                if(name==='weather') weatherApp.init();
                if(name==='taskmgr') taskMgr.init();
            }
        };
        const browser = {
            currentTab: 0,
            tabs: [{url: 'about:blank', title: 'Êñ∞„Åó„ÅÑ„Çø„Éñ'}],
            history: [],
            historyIndex: -1,
            bookmarks: JSON.parse(localStorage.getItem('browser-bookmarks') || '[]'),
            homeUrl: 'https://ja.m.wikipedia.org/wiki/Main_Page',
            
            init: () => {
                browser.loadBookmarks();
                const f = document.getElementById('browser-frame-0');
                if(f && f.src==='about:blank') {
                    browser.goTo(browser.homeUrl);
                }
            },
            
            getCurrentFrame: () => {
                return document.getElementById(`browser-frame-${browser.currentTab}`);
            },
            
            goTo: (url) => {
                const frame = browser.getCurrentFrame();
                if(!frame) return;
                
                // Add to history
                if(browser.history[browser.historyIndex] !== url) {
                    browser.history = browser.history.slice(0, browser.historyIndex + 1);
                    browser.history.push(url);
                    browser.historyIndex = browser.history.length - 1;
                }
                
                frame.src = url;
                document.getElementById('browser-url').value = url;
                browser.updateTabTitle(browser.currentTab, url);
            },
            
            go: () => {
                let u = document.getElementById('browser-url').value.trim();
                if(!u) return;
                if(!u.startsWith('http://') && !u.startsWith('https://')) {
                    u = 'https://' + u;
                }
                browser.goTo(u);
            },
            
            goBack: () => {
                if(browser.historyIndex > 0) {
                    browser.historyIndex--;
                    const url = browser.history[browser.historyIndex];
                    browser.getCurrentFrame().src = url;
                    document.getElementById('browser-url').value = url;
                }
            },
            
            goForward: () => {
                if(browser.historyIndex < browser.history.length - 1) {
                    browser.historyIndex++;
                    const url = browser.history[browser.historyIndex];
                    browser.getCurrentFrame().src = url;
                    document.getElementById('browser-url').value = url;
                }
            },
            
            refresh: () => {
                const frame = browser.getCurrentFrame();
                if(frame) frame.src = frame.src;
            },
            
            home: () => {
                browser.goTo(browser.homeUrl);
            },
            
            addBookmark: () => {
                const url = document.getElementById('browser-url').value;
                const title = url.replace(/^https?:\/\//, '').split('/')[0];
                browser.bookmarks.push({url, title});
                localStorage.setItem('browser-bookmarks', JSON.stringify(browser.bookmarks));
                browser.loadBookmarks();
            },
            
            loadBookmarks: () => {
                const container = document.getElementById('browser-bookmarks');
                if(browser.bookmarks.length > 0) {
                    container.style.display = 'flex';
                    container.innerHTML = browser.bookmarks.map((bm, i) => 
                        `<div class="browser-bookmark" onclick="browser.goTo('${bm.url}')">${bm.title}</div>`
                    ).join('');
                } else {
                    container.style.display = 'none';
                }
            },
            
            showHistory: () => {
                const container = document.getElementById('browser-bookmarks');
                if(container.style.display === 'none' || container.style.display === '') {
                    container.style.display = 'flex';
                    container.innerHTML = browser.history.slice(-10).reverse().map(url => 
                        `<div class="browser-bookmark" onclick="browser.goTo('${url}')">${url}</div>`
                    ).join('');
                } else {
                    browser.loadBookmarks();
                }
            },
            
            newTab: () => {
                const tabId = browser.tabs.length;
                browser.tabs.push({url: 'about:blank', title: 'Êñ∞„Åó„ÅÑ„Çø„Éñ'});
                browser.currentTab = tabId;
                
                // Add tab button
                const tabsContainer = document.getElementById('browser-tabs');
                const tab = document.createElement('div');
                tab.className = 'browser-tab active';
                tab.dataset.tab = tabId;
                tab.innerHTML = `<span>Êñ∞„Åó„ÅÑ„Çø„Éñ</span><span class="browser-tab-close" onclick="browser.closeTab(${tabId}, event)">√ó</span>`;
                tab.onclick = () => browser.switchTab(tabId);
                tabsContainer.appendChild(tab);
                
                // Update other tabs
                document.querySelectorAll('.browser-tab').forEach(t => {
                    if(parseInt(t.dataset.tab) !== tabId) t.classList.remove('active');
                });
                
                // Add iframe
                const container = document.getElementById('browser-frames-container');
                const frame = document.createElement('iframe');
                frame.className = 'browser-frame active';
                frame.id = `browser-frame-${tabId}`;
                frame.dataset.tab = tabId;
                frame.src = 'about:blank';
                frame.style.cssText = 'width:100%; height:100%; border:none; display:block;';
                container.appendChild(frame);
                
                browser.goTo(browser.homeUrl);
            },
            
            switchTab: (tabId) => {
                browser.currentTab = tabId;
                document.querySelectorAll('.browser-tab').forEach(t => {
                    t.classList.toggle('active', parseInt(t.dataset.tab) === tabId);
                });
                document.querySelectorAll('.browser-frame').forEach(f => {
                    f.classList.toggle('active', parseInt(f.dataset.tab) === tabId);
                    f.style.display = parseInt(f.dataset.tab) === tabId ? 'block' : 'none';
                });
                const tab = browser.tabs[tabId];
                if(tab) {
                    document.getElementById('browser-url').value = tab.url;
                }
            },
            
            closeTab: (tabId, e) => {
                e.stopPropagation();
                if(browser.tabs.length <= 1) return;
                
                browser.tabs.splice(tabId, 1);
                document.querySelector(`.browser-tab[data-tab="${tabId}"]`)?.remove();
                document.getElementById(`browser-frame-${tabId}`)?.remove();
                
                if(browser.currentTab === tabId) {
                    browser.currentTab = Math.max(0, tabId - 1);
                    browser.switchTab(browser.currentTab);
                }
            },
            
            updateTabTitle: (tabId, url) => {
                const tab = browser.tabs[tabId];
                if(tab) {
                    tab.url = url;
                    const title = url.replace(/^https?:\/\//, '').split('/')[0];
                    tab.title = title;
                    const tabEl = document.querySelector(`.browser-tab[data-tab="${tabId}"]`);
                    if(tabEl) {
                        tabEl.querySelector('span:first-child').textContent = title;
                    }
                }
            }
        };
        
        // Add new tab button
        document.addEventListener('DOMContentLoaded', () => {
            const tabsContainer = document.getElementById('browser-tabs');
            if(tabsContainer) {
                const newTabBtn = document.createElement('div');
                newTabBtn.className = 'browser-tab';
                newTabBtn.innerHTML = '+';
                newTabBtn.style.cursor = 'pointer';
                newTabBtn.onclick = () => browser.newTab();
                tabsContainer.appendChild(newTabBtn);
            }
        });

        /* --- MINESWEEPER LOGIC --- */
        const minesweeper = {
            rows: 9, cols: 9, bombCount: 10,
            grid: [], bombs: [], revealed: [], flagged: [],
            gameOver: false, timer: 0, timerInt: null,

            init: () => {
                const ms = minesweeper;
                ms.gameOver = false;
                ms.grid = document.getElementById('ms-grid');
                ms.grid.innerHTML = '';
                ms.bombs = Array(ms.rows * ms.cols).fill(false);
                ms.revealed = Array(ms.rows * ms.cols).fill(false);
                ms.flagged = Array(ms.rows * ms.cols).fill(false);
                document.getElementById('ms-face-btn').textContent = 'üôÇ';
                document.getElementById('ms-bomb-count').textContent = ms.pad(ms.bombCount);
                
                // Place bombs
                let placed = 0;
                while(placed < ms.bombCount) {
                    let idx = Math.floor(Math.random() * (ms.rows * ms.cols));
                    if(!ms.bombs[idx]) { ms.bombs[idx] = true; placed++; }
                }

                // Create Cells
                for(let i=0; i<ms.rows*ms.cols; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'ms-cell';
                    cell.onmousedown = (e) => {
                        if(ms.gameOver) return;
                        document.getElementById('ms-face-btn').textContent = 'üòÆ';
                        if(e.button === 2) ms.toggleFlag(i);
                        else if(e.button === 0) ms.reveal(i);
                    };
                    cell.onmouseup = () => {
                        if(!ms.gameOver) document.getElementById('ms-face-btn').textContent = 'üôÇ';
                    };
                    ms.grid.appendChild(cell);
                }
                
                // Timer
                if(ms.timerInt) clearInterval(ms.timerInt);
                ms.timer = 0;
                document.getElementById('ms-timer').textContent = '000';
                ms.timerInt = setInterval(()=>{
                    if(!ms.gameOver) {
                        ms.timer++;
                        document.getElementById('ms-timer').textContent = ms.pad(Math.min(999, ms.timer));
                    }
                }, 1000);
            },

            reset: () => {
                if(minesweeper.timerInt) clearInterval(minesweeper.timerInt);
            },

            toggleFlag: (idx) => {
                if(minesweeper.revealed[idx]) return;
                minesweeper.flagged[idx] = !minesweeper.flagged[idx];
                const cell = minesweeper.grid.children[idx];
                cell.textContent = minesweeper.flagged[idx] ? 'üö©' : '';
                // Update count
                let flags = minesweeper.flagged.filter(Boolean).length;
                document.getElementById('ms-bomb-count').textContent = minesweeper.pad(minesweeper.bombCount - flags);
            },

            reveal: (idx) => {
                const ms = minesweeper;
                if(ms.revealed[idx] || ms.flagged[idx]) return;

                ms.revealed[idx] = true;
                const cell = ms.grid.children[idx];
                cell.classList.add('revealed');

                if(ms.bombs[idx]) {
                    // Hit Bomb
                    cell.classList.add('bomb-revealed');
                    cell.textContent = 'üí£';
                    ms.endGame(false);
                } else {
                    // Number or Empty
                    let count = ms.countBombs(idx);
                    if(count > 0) {
                        cell.textContent = count;
                        cell.classList.add('ms-c'+count);
                    } else {
                        // Flood fill
                        ms.getNeighbors(idx).forEach(n => ms.reveal(n));
                    }
                    ms.checkWin();
                }
            },

            countBombs: (idx) => {
                return minesweeper.getNeighbors(idx).filter(n => minesweeper.bombs[n]).length;
            },

            getNeighbors: (idx) => {
                const r = Math.floor(idx / 9), c = idx % 9;
                const n = [];
                for(let dr=-1; dr<=1; dr++) {
                    for(let dc=-1; dc<=1; dc++) {
                        if(dr===0 && dc===0) continue;
                        const nr = r+dr, nc = c+dc;
                        if(nr>=0 && nr<9 && nc>=0 && nc<9) n.push(nr*9 + nc);
                    }
                }
                return n;
            },

            checkWin: () => {
                const ms = minesweeper;
                let safeCells = (ms.rows * ms.cols) - ms.bombCount;
                let revealedCount = ms.revealed.filter(Boolean).length;
                if(revealedCount === safeCells) ms.endGame(true);
            },

            endGame: (won) => {
                minesweeper.gameOver = true;
                clearInterval(minesweeper.timerInt);
                document.getElementById('ms-face-btn').textContent = won ? 'üòé' : 'üòµ';
                if(!won) {
                    // Reveal all bombs
                    minesweeper.bombs.forEach((isBomb, i) => {
                        if(isBomb) {
                            const cell = minesweeper.grid.children[i];
                            cell.textContent = 'üí£';
                            if(!minesweeper.revealed[i]) cell.style.background = '#c0c0c0'; // transparent reveal
                        }
                    });
                }
            },

            pad: (num) => num.toString().padStart(3, '0')
        };

        /* --- CALCULATOR --- */
        const calculator = {
            display: null,
            current: '0',
            previous: null,
            operation: null,
            init: () => {
                calculator.display = document.getElementById('calc-display');
                calculator.current = '0';
                calculator.previous = null;
                calculator.operation = null;
                calculator.updateDisplay();
                calculator.createButtons();
            },
            createButtons: () => {
                const buttons = [
                    ['C', 'clear'], ['/', 'operator'], ['*', 'operator'], ['-', 'operator'],
                    ['7', 'number'], ['8', 'number'], ['9', 'number'], ['+', 'operator'],
                    ['4', 'number'], ['5', 'number'], ['6', 'number'], ['=', 'equals'],
                    ['1', 'number'], ['2', 'number'], ['3', 'number'], ['', ''],
                    ['0', 'number'], ['.', 'number'], ['', ''], ['', '']
                ];
                const container = document.getElementById('calc-buttons');
                container.innerHTML = '';
                buttons.forEach(([label, type]) => {
                    if(!label) return;
                    const btn = document.createElement('button');
                    btn.className = `calc-btn ${type}`;
                    btn.textContent = label;
                    btn.onclick = () => calculator.handleInput(label, type);
                    container.appendChild(btn);
                });
            },
            handleInput: (value, type) => {
                if(type === 'number') {
                    if(calculator.current === '0') calculator.current = value;
                    else calculator.current += value;
                } else if(type === 'operator') {
                    if(calculator.previous !== null) calculator.calculate();
                    calculator.previous = calculator.current;
                    calculator.operation = value;
                    calculator.current = '0';
                } else if(type === 'equals') {
                    calculator.calculate();
                } else if(type === 'clear') {
                    calculator.current = '0';
                    calculator.previous = null;
                    calculator.operation = null;
                }
                calculator.updateDisplay();
            },
            calculate: () => {
                if(calculator.previous === null || calculator.operation === null) return;
                const prev = parseFloat(calculator.previous);
                const curr = parseFloat(calculator.current);
                let result = 0;
                switch(calculator.operation) {
                    case '+': result = prev + curr; break;
                    case '-': result = prev - curr; break;
                    case '*': result = prev * curr; break;
                    case '/': result = prev / curr; break;
                }
                calculator.current = result.toString();
                calculator.previous = null;
                calculator.operation = null;
            },
            updateDisplay: () => {
                calculator.display.textContent = calculator.current;
            }
        };

        /* --- CLOCK APP --- */
        const clockApp = {
            alarms: [],
            init: () => {
                clockApp.update();
                setInterval(clockApp.update, 1000);
            },
            update: () => {
                const now = new Date();
                const time = now.toLocaleTimeString('ja-JP');
                const date = now.toLocaleDateString('ja-JP', {year:'numeric', month:'long', day:'numeric', weekday:'long'});
                document.getElementById('clock-time-display').textContent = time;
                document.getElementById('clock-date').textContent = date;
                clockApp.checkAlarms(now);
            },
            addAlarm: () => {
                const hour = parseInt(document.getElementById('alarm-hour').value);
                const minute = parseInt(document.getElementById('alarm-minute').value);
                const time = `${hour.toString().padStart(2,'0')}:${minute.toString().padStart(2,'0')}`;
                clockApp.alarms.push({hour, minute, time});
                clockApp.updateAlarmList();
            },
            updateAlarmList: () => {
                const list = document.getElementById('alarm-list');
                list.innerHTML = clockApp.alarms.map((alarm, i) => 
                    `<div style="padding:5px; border-bottom:1px solid #ddd; display:flex; justify-content:space-between;">
                        <span>${alarm.time}</span>
                        <button onclick="clockApp.removeAlarm(${i})" style="padding:2px 8px;">ÂâäÈô§</button>
                    </div>`
                ).join('');
            },
            removeAlarm: (index) => {
                clockApp.alarms.splice(index, 1);
                clockApp.updateAlarmList();
            },
            checkAlarms: (now) => {
                clockApp.alarms.forEach(alarm => {
                    if(now.getHours() === alarm.hour && now.getMinutes() === alarm.minute && now.getSeconds() === 0) {
                        alert(`„Ç¢„É©„Éº„É†: ${alarm.time}`);
                    }
                });
            }
        };

        /* --- PAINT APP --- */
        const paintApp = {
            canvas: null,
            ctx: null,
            isDrawing: false,
            color: '#000000',
            size: 5,
            init: () => {
                paintApp.canvas = document.getElementById('paint-canvas');
                paintApp.ctx = paintApp.canvas.getContext('2d');
                paintApp.ctx.lineCap = 'round';
                paintApp.ctx.lineJoin = 'round';
                paintApp.canvas.onmousedown = (e) => {
                    paintApp.isDrawing = true;
                    const rect = paintApp.canvas.getBoundingClientRect();
                    paintApp.ctx.beginPath();
                    paintApp.ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
                };
                paintApp.canvas.onmousemove = (e) => {
                    if(!paintApp.isDrawing) return;
                    const rect = paintApp.canvas.getBoundingClientRect();
                    paintApp.ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
                    paintApp.ctx.stroke();
                };
                paintApp.canvas.onmouseup = () => paintApp.isDrawing = false;
                paintApp.canvas.onmouseleave = () => paintApp.isDrawing = false;
            },
            setColor: (color) => {
                paintApp.color = color;
                paintApp.ctx.strokeStyle = color;
            },
            setSize: (size) => {
                paintApp.size = parseInt(size);
                paintApp.ctx.lineWidth = paintApp.size;
                document.getElementById('paint-size-display').textContent = paintApp.size + 'px';
            },
            clear: () => {
                paintApp.ctx.clearRect(0, 0, paintApp.canvas.width, paintApp.canvas.height);
            }
        };
        // Initialize paint color and size
        setTimeout(() => {
            if(document.getElementById('paint-color')) {
                paintApp.setColor(document.getElementById('paint-color').value);
                paintApp.setSize(document.getElementById('paint-size').value);
            }
        }, 100);

        /* --- CALENDAR APP --- */
        const calendarApp = {
            currentDate: new Date(),
            init: () => {
                calendarApp.render();
            },
            render: () => {
                const year = calendarApp.currentDate.getFullYear();
                const month = calendarApp.currentDate.getMonth();
                const monthNames = ['1Êúà', '2Êúà', '3Êúà', '4Êúà', '5Êúà', '6Êúà', '7Êúà', '8Êúà', '9Êúà', '10Êúà', '11Êúà', '12Êúà'];
                document.getElementById('calendar-month-year').textContent = `${year}Âπ¥ ${monthNames[month]}`;
                
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - startDate.getDay());
                
                const grid = document.getElementById('calendar-grid');
                grid.innerHTML = '';
                
                const dayNames = ['Êó•', 'Êúà', 'ÁÅ´', 'Ê∞¥', 'Êú®', 'Èáë', 'Âúü'];
                dayNames.forEach(day => {
                    const header = document.createElement('div');
                    header.className = 'calendar-day-header';
                    header.textContent = day;
                    grid.appendChild(header);
                });
                
                const today = new Date();
                for(let i = 0; i < 42; i++) {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + i);
                    const day = document.createElement('div');
                    day.className = 'calendar-day';
                    day.textContent = date.getDate();
                    if(date.getMonth() !== month) day.classList.add('other-month');
                    if(date.toDateString() === today.toDateString()) day.classList.add('today');
                    grid.appendChild(day);
                }
            },
            prevMonth: () => {
                calendarApp.currentDate.setMonth(calendarApp.currentDate.getMonth() - 1);
                calendarApp.render();
            },
            nextMonth: () => {
                calendarApp.currentDate.setMonth(calendarApp.currentDate.getMonth() + 1);
                calendarApp.render();
            }
        };

        /* --- STOPWATCH APP --- */
        const stopwatchApp = {
            startTime: 0,
            elapsed: 0,
            interval: null,
            laps: [],
            init: () => {
                stopwatchApp.reset();
            },
            start: () => {
                if(stopwatchApp.interval) return;
                stopwatchApp.startTime = Date.now() - stopwatchApp.elapsed;
                stopwatchApp.interval = setInterval(() => {
                    stopwatchApp.elapsed = Date.now() - stopwatchApp.startTime;
                    stopwatchApp.updateDisplay();
                }, 10);
                document.getElementById('stopwatch-start').style.display = 'none';
                document.getElementById('stopwatch-stop').style.display = 'inline-block';
            },
            stop: () => {
                if(stopwatchApp.interval) {
                    clearInterval(stopwatchApp.interval);
                    stopwatchApp.interval = null;
                }
                document.getElementById('stopwatch-start').style.display = 'inline-block';
                document.getElementById('stopwatch-stop').style.display = 'none';
            },
            reset: () => {
                stopwatchApp.stop();
                stopwatchApp.elapsed = 0;
                stopwatchApp.laps = [];
                stopwatchApp.updateDisplay();
                document.getElementById('stopwatch-laps').innerHTML = '';
            },
            lap: () => {
                if(!stopwatchApp.interval) return;
                stopwatchApp.laps.push(stopwatchApp.elapsed);
                const lapList = document.getElementById('stopwatch-laps');
                const lapTime = stopwatchApp.formatTime(stopwatchApp.elapsed);
                lapList.innerHTML = `<div style="padding:5px; border-bottom:1px solid #ddd;">„É©„ÉÉ„Éó ${stopwatchApp.laps.length}: ${lapTime}</div>` + lapList.innerHTML;
            },
            updateDisplay: () => {
                document.getElementById('stopwatch-display').textContent = stopwatchApp.formatTime(stopwatchApp.elapsed);
            },
            formatTime: (ms) => {
                const totalSeconds = Math.floor(ms / 1000);
                const minutes = Math.floor(totalSeconds / 60);
                const seconds = totalSeconds % 60;
                const centiseconds = Math.floor((ms % 1000) / 10);
                return `${minutes.toString().padStart(2,'0')}:${seconds.toString().padStart(2,'0')}:${centiseconds.toString().padStart(2,'0')}`;
            }
        };

        /* --- FILE EXPLORER --- */
        const explorerApp = {
            currentPath: 'desktop',
            history: [],
            init: () => {
                explorerApp.navigate('desktop');
            },
            navigate: (path) => {
                explorerApp.history.push(explorerApp.currentPath);
                explorerApp.currentPath = path;
                const content = document.getElementById('explorer-content');
                const folders = {
                    desktop: ['üìÑ file1.txt', 'üñºÔ∏è image.jpg', 'üìÑ document.pdf', 'üéµ music.mp3'],
                    documents: ['üìÑ report.docx', 'üìÑ notes.txt', 'üìÑ presentation.pptx'],
                    pictures: ['üñºÔ∏è photo1.jpg', 'üñºÔ∏è photo2.png', 'üñºÔ∏è screenshot.png'],
                    music: ['üéµ song1.mp3', 'üéµ song2.mp3', 'üéµ album.mp3'],
                    videos: ['üé¨ video1.mp4', 'üé¨ movie.mp4']
                };
                content.innerHTML = `<div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap:10px;">
                    ${folders[path]?.map(f => `<div class="file-item" onclick="explorerApp.selectFile('${f}')">${f}</div>`).join('') || ''}
                </div>`;
            },
            goBack: () => {
                if(explorerApp.history.length > 0) {
                    explorerApp.currentPath = explorerApp.history.pop();
                    explorerApp.navigate(explorerApp.currentPath);
                }
            },
            goForward: () => {},
            refresh: () => explorerApp.navigate(explorerApp.currentPath),
            selectFile: (file) => {
                document.querySelectorAll('.file-item').forEach(item => item.classList.remove('selected'));
                event.target.classList.add('selected');
            }
        };

        /* --- MEDIA PLAYER --- */
        const mediaPlayer = {
            isPlaying: false,
            currentTime: 0,
            duration: 225,
            interval: null,
            songs: [
                {title: 'Sample Song 1', artist: 'Artist A'},
                {title: 'Sample Song 2', artist: 'Artist B'},
                {title: 'Sample Song 3', artist: 'Artist C'}
            ],
            currentSong: 0,
            init: () => {
                mediaPlayer.loadSong(0);
            },
            loadSong: (index) => {
                const song = mediaPlayer.songs[index];
                document.getElementById('media-title').textContent = song.title;
                document.getElementById('media-artist').textContent = song.artist;
                mediaPlayer.currentTime = 0;
                mediaPlayer.updateProgress();
            },
            toggle: () => {
                const btn = document.getElementById('media-play');
                if(mediaPlayer.isPlaying) {
                    mediaPlayer.pause();
                    btn.textContent = '‚ñ∂';
                } else {
                    mediaPlayer.play();
                    btn.textContent = '‚è∏';
                }
            },
            play: () => {
                mediaPlayer.isPlaying = true;
                mediaPlayer.interval = setInterval(() => {
                    mediaPlayer.currentTime++;
                    if(mediaPlayer.currentTime >= mediaPlayer.duration) {
                        mediaPlayer.next();
                    }
                    mediaPlayer.updateProgress();
                }, 1000);
            },
            pause: () => {
                mediaPlayer.isPlaying = false;
                if(mediaPlayer.interval) clearInterval(mediaPlayer.interval);
            },
            next: () => {
                mediaPlayer.currentSong = (mediaPlayer.currentSong + 1) % mediaPlayer.songs.length;
                mediaPlayer.loadSong(mediaPlayer.currentSong);
                if(mediaPlayer.isPlaying) mediaPlayer.play();
            },
            prev: () => {
                mediaPlayer.currentSong = (mediaPlayer.currentSong - 1 + mediaPlayer.songs.length) % mediaPlayer.songs.length;
                mediaPlayer.loadSong(mediaPlayer.currentSong);
                if(mediaPlayer.isPlaying) mediaPlayer.play();
            },
            seek: (e) => {
                const progress = e.currentTarget;
                const rect = progress.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                mediaPlayer.currentTime = Math.floor(mediaPlayer.duration * percent);
                mediaPlayer.updateProgress();
            },
            updateProgress: () => {
                const percent = (mediaPlayer.currentTime / mediaPlayer.duration) * 100;
                document.getElementById('media-progress').style.width = percent + '%';
                document.getElementById('media-time').textContent = mediaPlayer.formatTime(mediaPlayer.currentTime);
                document.getElementById('media-duration').textContent = mediaPlayer.formatTime(mediaPlayer.duration);
            },
            formatTime: (seconds) => {
                const mins = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return `${mins}:${secs.toString().padStart(2,'0')}`;
            }
        };

        /* --- WEATHER APP --- */
        const weatherApp = {
            init: () => {
                weatherApp.update();
            },
            update: () => {
                const temps = [18, 20, 22, 24, 26];
                const conditions = ['Êô¥„Çå', 'Êõá„Çä', 'Èõ®', 'Êô¥„Çå', 'Êô¥„Çå'];
                const icons = ['‚òÄÔ∏è', '‚òÅÔ∏è', 'üåßÔ∏è', '‚òÄÔ∏è', '‚òÄÔ∏è'];
                const random = Math.floor(Math.random() * temps.length);
                document.getElementById('weather-temp').textContent = temps[random] + '¬∞';
                document.getElementById('weather-desc').textContent = conditions[random];
                document.querySelector('.weather-main').innerHTML = 
                    `<div style="font-size:5rem; margin:20px 0;">${icons[random]}</div>` +
                    `<div class="weather-temp" id="weather-temp">${temps[random]}¬∞</div>` +
                    `<div class="weather-desc" id="weather-desc">${conditions[random]}</div>` +
                    `<div style="margin-top:10px; opacity:0.9;" id="weather-location">Êù±‰∫¨, Êó•Êú¨</div>`;
                document.getElementById('weather-feels').textContent = (temps[random] + 2) + '¬∞';
                document.getElementById('weather-humidity').textContent = (50 + Math.floor(Math.random() * 30)) + '%';
                document.getElementById('weather-wind').textContent = (5 + Math.floor(Math.random() * 15)) + ' km/h';
                document.getElementById('weather-pressure').textContent = (1000 + Math.floor(Math.random() * 30)) + ' hPa';
            },
            refresh: () => weatherApp.update()
        };

        /* --- TASK MANAGER --- */
        const taskMgr = {
            currentTab: 'processes',
            init: () => {
                taskMgr.updateProcesses();
                setInterval(taskMgr.updateProcesses, 2000);
            },
            switchTab: (tab) => {
                taskMgr.currentTab = tab;
                document.querySelectorAll('.taskmgr-tab').forEach(t => t.classList.remove('active'));
                event.target.classList.add('active');
                const content = document.getElementById('taskmgr-content');
                if(tab === 'processes') {
                    content.innerHTML = `<ul class="taskmgr-list" id="taskmgr-list"></ul>`;
                    taskMgr.updateProcesses();
                } else {
                    content.innerHTML = `
                        <div style="padding:20px;">
                            <h3>„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ</h3>
                            <div style="margin:20px 0;">
                                <div>CPU‰ΩøÁî®Áéá: <span id="cpu-usage">${(Math.random() * 30 + 20).toFixed(1)}%</span></div>
                                <div style="background:#e0e0e0; height:20px; border-radius:4px; margin:10px 0; overflow:hidden;">
                                    <div style="background:linear-gradient(to right, #4a90e2, #357abd); height:100%; width:${Math.random() * 30 + 20}%;"></div>
                                </div>
                            </div>
                            <div style="margin:20px 0;">
                                <div>„É°„É¢„É™‰ΩøÁî®Áéá: <span id="mem-usage">${(Math.random() * 40 + 30).toFixed(1)}%</span></div>
                                <div style="background:#e0e0e0; height:20px; border-radius:4px; margin:10px 0; overflow:hidden;">
                                    <div style="background:linear-gradient(to right, #4a90e2, #357abd); height:100%; width:${Math.random() * 40 + 30}%;"></div>
                                </div>
                            </div>
                        </div>
                    `;
                }
            },
            updateProcesses: () => {
                const list = document.getElementById('taskmgr-list');
                if(!list) return;
                const processes = [
                    {name: '„Éû„Ç§„É≥„Çπ„Ç§„Éº„Éë', mem: (Math.random() * 5 + 10).toFixed(1)},
                    {name: '„Éñ„É©„Ç¶„Ç∂', mem: (Math.random() * 20 + 30).toFixed(1)},
                    {name: '„É°„É¢Â∏≥', mem: (Math.random() * 3 + 5).toFixed(1)},
                    {name: 'Ë®àÁÆóÊ©ü', mem: (Math.random() * 2 + 3).toFixed(1)},
                    {name: 'ÊôÇË®à', mem: (Math.random() * 2 + 4).toFixed(1)},
                    {name: '„Éö„Ç§„É≥„Éà', mem: (Math.random() * 5 + 8).toFixed(1)},
                    {name: '„Ç´„É¨„É≥„ÉÄ„Éº', mem: (Math.random() * 3 + 6).toFixed(1)}
                ];
                list.innerHTML = processes.map(p => 
                    `<li class="taskmgr-item">
                        <span>${p.name}</span>
                        <span>${p.mem} MB</span>
                    </li>`
                ).join('');
            }
        };

    </script>
</body>
</html>